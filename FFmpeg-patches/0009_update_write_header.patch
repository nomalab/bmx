diff --git a/libavformat/bmxenc.c b/libavformat/bmxenc.c
index 45eabbc634..355ea9f262 100644
--- a/libavformat/bmxenc.c
+++ b/libavformat/bmxenc.c
@@ -57,13 +57,56 @@ static int bmx_write_header(AVFormatContext *s)
             case AV_CODEC_ID_MPEG2VIDEO:
                 if(st->codecpar->width == 1920 && st->codecpar->height == 1080) {
                     if(st->codecpar->field_order == AV_FIELD_PROGRESSIVE) {
-                        essence_type = MPEG2LG_422P_HL_1080P;
-                        break;
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_422 && st->codecpar->level == 2) {
+                            essence_type = MPEG2LG_422P_HL_1080P;
+                            break;
+                        }
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 4) {
+                            essence_type = MPEG2LG_MP_HL_1920_1080P;
+                            break;
+                        }
                     } else {
-                        essence_type = MPEG2LG_422P_HL_1080I;
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_422 && st->codecpar->level == 2) {
+                            essence_type = MPEG2LG_422P_HL_1080I;
+                            break;
+                        }
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 4) {
+                            essence_type = MPEG2LG_MP_HL_1920_1080I;
+                            break;
+                        }
+                    }
+                }
+                if(st->codecpar->width == 1280 && st->codecpar->height == 720) {
+                    if(st->codecpar->profile == FF_PROFILE_MPEG2_422 && st->codecpar->level == 2) {
+                        essence_type = MPEG2LG_422P_HL_720P;
+                        break;
+                    }
+                    if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 4) {
+                        essence_type = MPEG2LG_MP_HL_720P;
                         break;
                     }
                 }
+                if(st->codecpar->width == 1440 && st->codecpar->height == 1080) {
+                    if(st->codecpar->field_order == AV_FIELD_PROGRESSIVE) {
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 6) {
+                            essence_type = MPEG2LG_MP_H14_1080P;
+                            break;
+                        }
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 4) {
+                            essence_type = MPEG2LG_MP_HL_1440_1080P;
+                            break;
+                        }
+                    } else {
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 6) {
+                            essence_type = MPEG2LG_MP_H14_1080I;
+                            break;
+                        }
+                        if(st->codecpar->profile == FF_PROFILE_MPEG2_MAIN && st->codecpar->level == 4) {
+                            essence_type = MPEG2LG_MP_HL_1440_1080I;
+                            break;
+                        }
+                    }
+                }
             case AV_CODEC_ID_H264:
             case AV_CODEC_ID_PRORES:
                 break;
@@ -93,6 +136,9 @@ static int bmx_write_header(AVFormatContext *s)
                 if (bmx_avci_header(bmx->internal_data, i, bmx->ps_avcihead, essence_type) == 0) {
                     av_log(s, AV_LOG_INFO, "Set AVCI header for stream %d\n", i);
                 }
+                if (bmx->clip_type == CLIP_TYPE_D10) {
+                    bmx_set_aspect_ratio(bmx->internal_data, i, st->display_aspect_ratio.num, st->display_aspect_ratio.den);
+                }
             }
         }
     }
